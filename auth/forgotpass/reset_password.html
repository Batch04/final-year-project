<!DOCTYPE html>
<html>
<head>
  <title>Reset Password</title>
  <link rel="stylesheet" href="styles/styles.css">
</head>
<body>
 <div>
  <form id="resetForm">
     <h2>Reset Password</h2>
    <input type="hidden" name="email"id="email">
    <input type="hidden" name="token" id="token">
    <input type="password" id="password" placeholder=" Enter New Password" required>
    <input type="password" id="confirm_password" placeholder="Confirm Password" required>
    <button type="submit">Reset Password</button>
      <div id="message"></div>
  </form>

  </div>

  <script>
  const params = new URLSearchParams(window.location.search);
    document.getElementById("token").value = params.get("token")||"";
  document.getElementById("email").value = params.get("email")||"";


  document.getElementById("resetForm").addEventListener("submit", function(e){
      e.preventDefault();
      let email = document.getElementById("email").value;
      let token = document.getElementById("token").value;
      let password = document.getElementById("password").value;
      let confirm_password = document.getElementById("confirm_password").value;

      if(password !== confirm_password){
          document.getElementById("message").innerText = "Passwords do not match";
          return;
      }

      fetch("../../backend/reset_password.php", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({ email:email, token:token, password:password })
      })
      .then(res => res.json())
      .then(data => {
          document.getElementById("message").innerText = data.message;
          if(data.status === "success"){
              setTimeout(()=>{ window.location.href = "../home.html"; }, 2000);
          }
      });
  });
  </script>
</body>
</html>